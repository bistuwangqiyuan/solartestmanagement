# 光伏关断器实验数据管理系统 PRD
## 产品需求文档 v1.0

---

## 1. 产品概述

### 1.1 产品定位
光伏关断器实验数据管理系统是一个面向新能源行业的专业级工业数据管理平台，专注于光伏关断器测试数据的采集、存储、分析和可视化展示。系统采用现代化的工业设计理念，提供高效、直观、专业的数据管理解决方案。

### 1.2 产品愿景
打造光伏行业领先的测试数据管理平台，为光伏关断器的研发、生产和质量控制提供全方位的数据支撑，推动光伏产业的数字化转型和智能化升级。

### 1.3 核心价值
- **数据标准化**：建立光伏关断器测试数据的统一标准，确保数据的一致性和可比性
- **智能分析**：通过先进的数据分析算法，自动识别异常数据和性能趋势
- **实时监控**：提供实时数据大屏，动态展示关键性能指标
- **决策支持**：为工程师和管理层提供数据驱动的决策依据

---

## 2. 用户画像与使用场景

### 2.1 目标用户
- **测试工程师**：负责光伏关断器的日常测试和数据记录
- **质量管理人员**：监督产品质量，分析不良率和故障原因
- **研发工程师**：基于测试数据进行产品改进和优化
- **管理层**：通过数据大屏了解整体生产和质量状况

### 2.2 使用场景
1. **数据录入场景**：测试完成后，通过Excel文件批量导入测试数据
2. **数据查询场景**：根据时间、设备、参数等条件快速检索历史数据
3. **数据分析场景**：对比不同批次、不同条件下的测试结果
4. **监控展示场景**：在生产车间大屏实时显示关键指标
5. **报告生成场景**：自动生成测试报告和质量分析报告

---

## 3. 功能需求

### 3.1 数据管理模块

#### 3.1.1 Excel数据导入
- **批量导入**：支持多个Excel文件同时上传
- **格式校验**：自动检测并验证Excel格式
- **数据预览**：导入前预览数据，支持修改和确认
- **导入历史**：记录所有导入操作，支持数据追溯
- **冲突处理**：智能识别重复数据，提供合并或覆盖选项

#### 3.1.2 数据CRUD操作
- **创建**：手动录入单条测试数据
- **查询**：多维度筛选（时间范围、电压、电流、功率等）
- **更新**：编辑已有数据，记录修改历史
- **删除**：软删除机制，保留数据痕迹
- **批量操作**：支持批量修改和删除

#### 3.1.3 数据标准化
- **参数映射**：将不同格式的Excel数据映射到统一标准
- **单位转换**：自动识别和转换不同单位
- **数据清洗**：去除异常值和无效数据
- **质量评分**：对数据完整性和准确性进行评分

### 3.2 数据可视化大屏

#### 3.2.1 实时监控面板
- **关键指标卡片**
  - 今日测试数量
  - 合格率
  - 平均功率
  - 设备利用率
- **趋势图表**
  - 24小时测试量趋势
  - 合格率变化曲线
  - 功率分布直方图
- **设备状态**
  - 在线设备数量
  - 设备运行状态
  - 故障预警

#### 3.2.2 数据分析大屏
- **性能分析**
  - I-V特性曲线
  - P-V功率曲线
  - 效率分布图
- **质量分析**
  - 不良品分类统计
  - 故障原因分析
  - 批次对比分析
- **3D数据展示**
  - 三维散点图展示多参数关系
  - 热力图展示参数分布

#### 3.2.3 生产监控大屏
- **产线状态**
  - 各产线实时产量
  - 设备OEE指标
  - 异常事件时间轴
- **质量看板**
  - 实时良率
  - 质量趋势预测
  - 关键质量指标雷达图

### 3.3 报表与分析

#### 3.3.1 标准报表
- **日报**：当日测试汇总、质量概况
- **周报**：周趋势分析、问题汇总
- **月报**：月度综合分析、改进建议
- **自定义报表**：灵活配置报表内容和格式

#### 3.3.2 高级分析
- **相关性分析**：分析各参数之间的相关性
- **异常检测**：基于历史数据的异常值自动识别
- **预测分析**：基于机器学习的质量趋势预测
- **对比分析**：不同时期、不同批次的对比

### 3.4 系统管理

#### 3.4.1 用户管理
- **角色权限**：测试员、工程师、管理员等角色
- **权限控制**：基于角色的功能和数据访问控制
- **操作审计**：记录所有用户操作日志

#### 3.4.2 设备管理
- **设备台账**：管理测试设备信息
- **设备校准**：记录校准历史和证书
- **维护计划**：设备保养提醒和记录

#### 3.4.3 系统配置
- **参数设置**：测试参数标准值配置
- **告警规则**：异常数据告警阈值设置
- **界面定制**：大屏布局和主题定制

---

## 4. 非功能需求

### 4.1 性能要求
- **响应时间**：页面加载 < 2秒，API响应 < 500ms
- **并发支持**：支持100个用户同时在线
- **数据处理**：单次可导入10万条数据
- **实时性**：数据大屏刷新延迟 < 5秒

### 4.2 可用性要求
- **系统可用性**：99.9%的正常运行时间
- **数据备份**：自动备份，支持快速恢复
- **容错机制**：关键功能具备降级方案

### 4.3 安全要求
- **数据加密**：传输和存储均采用加密
- **访问控制**：基于JWT的身份认证
- **审计日志**：完整的操作记录和追溯

### 4.4 兼容性要求
- **浏览器支持**：Chrome、Firefox、Safari、Edge最新版本
- **响应式设计**：支持1920x1080、2560x1440、3840x2160分辨率
- **移动端适配**：关键功能支持平板访问

---

## 5. 界面设计规范

### 5.1 设计理念
- **工业美学**：简约而不简单，突出专业性和科技感
- **数据优先**：以数据展示为核心，减少视觉干扰
- **操作高效**：最小化操作步骤，提供快捷方式

### 5.2 视觉规范

#### 5.2.1 色彩体系
- **主色调**：深空灰 (#1a1a1a) - 专业稳重
- **品牌色**：电光蓝 (#00d4ff) - 科技活力
- **辅助色**：
  - 成功绿 (#00ff88) - 正常/合格
  - 警告橙 (#ff9500) - 警告/注意
  - 危险红 (#ff3b30) - 错误/不合格
- **中性色**：
  - 背景色：#0a0a0a (深黑)、#1a1a1a (次深)、#2a2a2a (卡片背景)
  - 文字色：#ffffff (主要)、#b0b0b0 (次要)、#808080 (辅助)

#### 5.2.2 字体规范
- **主字体**：Inter (英文) / Noto Sans SC (中文)
- **数据字体**：Roboto Mono (等宽字体用于数据展示)
- **字号体系**：
  - 大标题：32px
  - 标题：24px
  - 副标题：18px
  - 正文：14px
  - 辅助文字：12px

#### 5.2.3 组件规范
- **卡片**：圆角8px，边框1px (#333333)，阴影效果
- **按钮**：圆角4px，主按钮使用品牌色，次按钮使用边框样式
- **输入框**：深色背景，聚焦时发光边框效果
- **图表**：暗色主题，使用渐变和发光效果增强视觉冲击力

### 5.3 交互规范
- **动画效果**：平滑过渡，避免突兀变化
- **加载状态**：骨架屏和进度指示器
- **错误处理**：友好的错误提示和恢复建议
- **快捷键**：支持键盘快捷操作

---

## 6. 技术架构

### 6.1 技术栈
- **前端框架**：Next.js 14 (App Router)
- **UI组件库**：Tailwind CSS + Shadcn/ui
- **数据可视化**：ECharts + D3.js
- **状态管理**：Zustand
- **后端服务**：Supabase (PostgreSQL + Realtime + Auth)
- **文件处理**：xlsx.js (Excel解析)
- **部署平台**：Netlify

### 6.2 数据库设计

#### 6.2.1 核心数据表
```sql
-- 测试数据主表
CREATE TABLE test_records (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    test_date TIMESTAMP NOT NULL,
    voltage DECIMAL(10,2),
    current DECIMAL(10,2),
    power DECIMAL(10,2),
    device_address INTEGER,
    device_type VARCHAR(50),
    batch_id UUID,
    import_id UUID,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

-- 导入批次表
CREATE TABLE import_batches (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    file_name VARCHAR(255),
    import_date TIMESTAMP DEFAULT NOW(),
    record_count INTEGER,
    user_id UUID,
    status VARCHAR(20)
);

-- 设备信息表
CREATE TABLE devices (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    device_address INTEGER UNIQUE,
    device_name VARCHAR(100),
    device_type VARCHAR(50),
    calibration_date DATE,
    status VARCHAR(20)
);

-- 数据分析结果表
CREATE TABLE analysis_results (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    analysis_date TIMESTAMP DEFAULT NOW(),
    analysis_type VARCHAR(50),
    parameters JSONB,
    results JSONB
);
```

### 6.3 API设计
- **RESTful API**：标准CRUD操作
- **GraphQL**：复杂查询和数据聚合
- **WebSocket**：实时数据推送
- **文件上传**：支持大文件分片上传

---

## 7. 项目实施计划

### 7.1 开发阶段
1. **第一阶段（2周）**：基础架构搭建
   - Next.js项目初始化
   - Supabase配置和数据库设计
   - 基础UI组件开发

2. **第二阶段（3周）**：核心功能开发
   - Excel数据导入功能
   - 数据CRUD操作
   - 基础数据展示

3. **第三阶段（3周）**：数据大屏开发
   - 实时监控大屏
   - 数据分析大屏
   - 生产监控大屏

4. **第四阶段（2周）**：高级功能
   - 报表生成
   - 数据分析算法
   - 用户权限管理

5. **第五阶段（1周）**：优化与部署
   - 性能优化
   - 安全加固
   - Netlify部署配置

### 7.2 里程碑
- M1：基础版本上线（数据导入和查看）
- M2：数据大屏功能完成
- M3：全功能版本发布
- M4：生产环境稳定运行

---

## 8. 风险与对策

### 8.1 技术风险
- **数据量大**：采用分页加载和虚拟滚动技术
- **实时性要求高**：使用Supabase Realtime和缓存策略
- **Excel格式多样**：建立格式适配器和映射规则

### 8.2 业务风险
- **需求变更**：采用敏捷开发，快速迭代
- **数据安全**：严格的权限控制和数据加密
- **用户接受度**：提供培训和操作手册

---

## 9. 成功指标

### 9.1 业务指标
- 数据录入效率提升50%
- 数据查询速度提升80%
- 报表生成时间减少70%
- 用户满意度达到90%

### 9.2 技术指标
- 系统可用性 > 99.9%
- 页面加载时间 < 2秒
- 并发用户数 > 100
- 数据准确率 > 99.99%

---

## 10. 附录

### 10.1 术语表
- **光伏关断器**：用于光伏系统安全保护的关键设备
- **I-V曲线**：电流-电压特性曲线
- **P-V曲线**：功率-电压特性曲线
- **OEE**：设备综合效率指标

### 10.2 参考资料
- 光伏行业测试标准
- 工业4.0数据管理最佳实践
- Next.js官方文档
- Supabase开发指南